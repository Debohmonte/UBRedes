<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Facturas</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f4f4f4; }
        h1 { font-size: 24px; font-weight: bold; }
        header { display: flex; align-items: center; background-color: beige; padding: 20px; }
        label { font-size: 18px; font-weight: bold; margin-right: 10px; }
        input, button { height: 30px; font-size: 14px; margin-right: 10px; }
        button { background-color: lightgray; border: 1px solid black; height: 50px; width: 150px; cursor: pointer; }
        button:hover { background-color: #ddd; }
        .container { background-color: beige; padding: 10px; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        table, th, td { border: 1px solid #ddd; }
        th, td { padding: 12px; text-align: center; }
        footer { background-color: #FF7361; height: 30px; margin-top: 10px; }
        .modal { display: none; position: fixed; z-index: 1; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.4); }
        .modal-content { background-color: #fff; margin: 10% auto; padding: 20px; border: 1px solid #888; width: 50%; border-radius: 8px; }
        .close { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; }
        .close:hover { color: black; }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1 style="margin-right: auto;">Facturas</h1>
            <label for="orden">Orden:</label>
            <input type="text" id="orden" name="orden" value="fecha" readonly>
            <button id="btCargarDatos">Cargar datos</button>
            <button id="btVaciarDatos">Vaciar datos</button>
            <button id="btLimpiarFiltros">Limpiar filtros</button>
            <button id="btAltaRegistro">Alta registro</button>
        </header>

        <table id="data-table">
            <thead>
                <tr>
                    <th>Número Factura</th>
                    <th>CUIL Emisor</th>
                    <th>CUIL Receptor</th>
                    <th>Monto</th>
                    <th>IVA</th>
                    <th>Total</th>
                    <th>Descripción</th> <!-- Updated to 'Descripción' -->
                    <th>Fecha</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>
    </div>

    <footer></footer>

    <!-- Alta Modal -->
    <div id="altaModal" class="modal">
        <div class="modal-content">
            <span class="close" id="closeAltaModal">&times;</span>
            <h2>Crear Nueva Factura</h2>
            <form id="formAlta" method="POST" action="alta_factura.php">
                <label for="nro_factura">Número Factura</label>
                <input type="text" id="nro_factura" name="nro_factura" required>

                <label for="cuil_emisor">CUIL Emisor</label>
                <input type="text" id="cuil_emisor" name="cuil_emisor" required>

                <label for="cuil_receptor">CUIL Receptor</label>
                <input type="text" id="cuil_receptor" name="cuil_receptor" required>

                <label for="monto">Monto</label>
                <input type="number" id="monto" name="monto" required min="0" step="0.01">

                <label for="iva">IVA</label>
                <input type="number" id="iva" name="iva" required min="0" step="0.01">

                <label for="total">Total</label>
                <input type="number" id="total" name="total" required min="0" step="0.01">

                <!-- Updated to 'Descripción' -->
                <label for="descripcion">Descripción de Factura</label>
                <input type="text" id="descripcion" name="descripcion" required>

                <label for="fecha">Fecha</label>
                <input type="date" id="fecha" name="fecha" required>

                <button type="submit">Guardar Factura</button>
            </form>
        </div>
    </div>

    <script>
        var altaModal = document.getElementById("altaModal");
        var openAltaModalBtn = document.getElementById("btAltaRegistro");
        var closeAltaModalBtn = document.getElementById("closeAltaModal");

        openAltaModalBtn.onclick = function() {
            altaModal.style.display = "block";
        }
        closeAltaModalBtn.onclick = function() {
            altaModal.style.display = "none";
        }
        window.onclick = function(event) {
            if (event.target == altaModal) {
                altaModal.style.display = "none";
            }
        }

        // Cargar datos
        document.getElementById('btCargarDatos').addEventListener('click', function() {
            fetch('cargar_datos.php', { method: 'GET' })
            .then(response => response.json())
            .then(data => {
                const tableBody = document.querySelector('#data-table tbody');
                tableBody.innerHTML = '';  // Clear previous data
                data.forEach(item => {
                    const row = `<tr>
                                    <td>${item.nro_factura}</td>
                                    <td>${item.cuil_emisor}</td>
                                    <td>${item.cuil_receptor}</td>
                                    <td>${item.monto}</td>
                                    <td>${item.iva}</td>
                                    <td>${item.total}</td>
                                    <td>${item.descripcion}</td> <!-- Updated to 'descripcion' -->
                                    <td>${item.fecha}</td>
                                </tr>`;
                    tableBody.innerHTML += row;
                });
            })
            .catch(error => {
                console.error('Error fetching data:', error);
            });
        });

        // Vaciar datos
        document.getElementById('btVaciarDatos').addEventListener('click', function() {
            document.querySelector('#data-table tbody').innerHTML = ''; // Clear table data
        });

        // Limpiar filtros
        document.getElementById('btLimpiarFiltros').addEventListener('click', function() {
            document.getElementById('orden').value = 'fecha'; // Reset filters
        });
    </script>
</body>
</html>
