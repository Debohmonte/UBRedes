<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Facturas</title>
    <style>
        /* Estilos globales */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        html, body {
            height: 100%;
            width: 100%;
        }
        body {
            font-size: 14px;
            font-family: Arial, sans-serif;
        }

        div.contenedorTabla {
            width: 100%;
            height: 100%;
            background-color: gray;
        }

        div.contenedorTabla h1 {
            text-align: center;
            margin-bottom: 10px;
        }

        div.contenedorTabla header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: beige;
            padding: 10px;
        }

        div.contenedorTabla header button {
            padding: 10px 15px;
            background-color: #FF7361;
            border: none;
            cursor: pointer;
        }

        div.contenedorTabla table {
            width: 100%;
            border-collapse: collapse;
        }

        div.contenedorTabla thead {
            background-color: #FF7361;
        }

        div.contenedorTabla thead th {
            padding: 10px;
            text-align: center;
            font-weight: bold;
        }

        div.contenedorTabla tbody tr {
            height: 50px;
        }

        div.contenedorTabla tbody td {
            padding: 10px;
            text-align: center;
        }

        div.contenedorTabla tfoot td {
            font-weight: bold;
            padding: 10px;
            text-align: center;
        }

        div.contenedorTabla footer {
            background-color: beige;
            padding: 10px;
        }
    </style>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script>
        $(document).ready(function() {
            $("#btAccionCarga").click(function() {
                cargarFacturas();
            });

            function cargarFacturas() {
                // Limpiar los datos actuales de la tabla
                $("#tbDatos").empty();
                $("#tbDatos").html("<p>Esperando respuesta...</p>");

                // Hacer la llamada AJAX a PHP
                $.ajax({
                    type: "get",
                    url: "./salidaJsonFacturas.php", 
                    data: {
                        f_numero: $("#f_factura_numero").val(),
                        f_cuil_emisor: $("#f_factura_cuil_emisor").val(),
                        f_cuil_receptor: $("#f_factura_cuil_receptor").val(),
                        f_monto: $("#f_factura_monto").val(),
                        f_iva: $("#f_factura_iva").val(),
                        f_total: $("#f_factura_total").val()
                    },
                    success: function(respuestaDelServer) {
                        // Limpiar la tabla después de recibir los datos
                        $("#tbDatos").empty();
                        let facturas = JSON.parse(respuestaDelServer).facturas;

                        // Recorrer cada factura y agregarla a la tabla
                        facturas.forEach(function(factura) {
                            let tr = $("<tr></tr>");
                            $("<td></td>").text(factura.numero).appendTo(tr);
                            $("<td></td>").text(factura.cuil_emisor).appendTo(tr);
                            $("<td></td>").text(factura.cuil_receptor).appendTo(tr);
                            $("<td></td>").text(factura.monto).appendTo(tr);
                            $("<td></td>").text(factura.iva).appendTo(tr);
                            $("<td></td>").text(factura.total).appendTo(tr);

                            $("#tbDatos").append(tr);
                        });

                        // Actualizar el número de registros en la tabla
                        $("#totalRegistros").text("Nro de registros: " + facturas.length);
                    }
                });
            }
        });
    </script>
</head>
<body>
    <div class="contenedorTabla">
        <header>
            <h1>Facturas</h1>
            <button id="btAccionCarga">Cargar datos</button>
        </header>

        <table>
            <thead>
                <tr>
                    <th>Número</th>
                    <th>CUIL Emisor</th>
                    <th>CUIL Receptor</th>
                    <th>Monto</th>
                    <th>IVA</th>
                    <th>Total</th>
                </tr>
                <tr>
                    <td><input id="f_factura_numero" type="text"></td>
                    <td><input id="f_factura_cuil_emisor" type="text"></td>
                    <td><input id="f_factura_cuil_receptor" type="text"></td>
                    <td><input id="f_factura_monto" type="text"></td>
                    <td><input id="f_factura_iva" type="text"></td>
                    <td><input id="f_factura_total" type="text"></td>
                </tr>
            </thead>

            <tbody id="tbDatos"></tbody>

            <tfoot>
                <tr>
                    <td colspan="6" id="totalRegistros">Nro de registros: 0</td>
                </tr>
            </tfoot>
        </table>
    </div>
</body>
</html>
